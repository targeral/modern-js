(self.webpackChunk_modern_js_main_doc=self.webpackChunk_modern_js_main_doc||[]).push([["docs_en_apis_app_hooks_api_functions_api_mdx"],{93906:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});!function(e,n){for(var i in n)Object.defineProperty(e,i,{enumerable:!0,get:n[i]})}(n,{frontmatter:function(){return t},title:function(){return l},toc:function(){return r},default:function(){return o}});var s=i("12151"),d=i("23169"),t={title:"**/*.[tj]s",sidebar_position:1},l="**/*.[tj]s",r=[{text:"Routing Rule",depth:2,id:"routing-rule"},{text:"Default Route",depth:3,id:"default-route"},{text:"Multi Level Route",depth:3,id:"multi-level-route"},{text:"Dynamic Route",depth:3,id:"dynamic-route"},{text:"Allow List",depth:3,id:"allow-list"},{text:"Define Function",depth:2,id:"define-function"}];function c(e){var n=Object.assign({h1:"h1",a:"a",p:"p",code:"code",div:"div",h2:"h2",h3:"h3",ul:"ul",li:"li",button:"button",pre:"pre"},(0,d.useMDXComponents)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"**/*-[tj]s",children:["**/*.[tj]s",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#**/*-[tj]s",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Declaring API routing in BFF function mode. Except ",(0,s.jsx)(n.a,{href:"/apis/app/hooks/api/functions/api#allow-list",children:"some files"}),", files in ",(0,s.jsx)(n.code,{children:"api/"})," are registered as routes."]}),"\n",(0,s.jsxs)(n.div,{className:"modern-directive info",children:[(0,s.jsx)(n.div,{className:"modern-directive-title",children:"INFO"}),(0,s.jsxs)(n.div,{className:"modern-directive-content",children:[(0,s.jsxs)(n.p,{children:["use ",(0,s.jsx)(n.code,{children:"api/"})," need execute new command to enable the 「BFF」 feature."]}),"\n"]})]}),"\n",(0,s.jsxs)(n.div,{className:"modern-directive tip",children:[(0,s.jsx)(n.div,{className:"modern-directive-title",children:"TIP"}),(0,s.jsxs)(n.div,{className:"modern-directive-content",children:[(0,s.jsxs)(n.p,{children:["this file supports the use ",(0,s.jsx)(n.code,{children:"js"})," or ",(0,s.jsx)(n.code,{children:"ts"}),", but the functions must be exported using the ESM syntax."]}),"\n"]})]}),"\n",(0,s.jsxs)(n.h2,{id:"routing-rule",children:["Routing Rule",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#routing-rule",children:"#"})]}),"\n",(0,s.jsxs)(n.h3,{id:"default-route",children:["Default Route",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#default-route",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["The files named ",(0,s.jsx)(n.code,{children:"index"})," will be upper level routing:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/index.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/user/index.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/user"})]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"multi-level-route",children:["Multi Level Route",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#multi-level-route",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"The routing system also supports parsing multiple levels of files. and if you create a folder, the files will still be automatically parsed in the same way."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/hello.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/hello"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/user/list.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/user/list"})]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"dynamic-route",children:["Dynamic Route",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#dynamic-route",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["Dynamic named routing parameters can be supported by creating folders or files with ",(0,s.jsx)(n.code,{children:"[xxx]"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/user/[username]/info.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/user/:username/info"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/user/[username]/delete.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/user/:username/delete"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api/article/[id]/info.ts"})," -> ",(0,s.jsx)(n.code,{children:"$BASENAME/article/:id/info"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["the ",(0,s.jsx)(n.code,{children:"$BASENAME"})," can be configured in ",(0,s.jsx)(n.code,{children:"modern.config.js"}),", the default value is ",(0,s.jsx)(n.code,{children:"/api"}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"allow-list",children:["Allow List",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#allow-list",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["By default, all files in the ",(0,s.jsx)(n.code,{children:"api/"})," will be parsed as BFF function. but we also set a allow list, and these files will not be parsed:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["file name start with ",(0,s.jsx)(n.code,{children:"_"}),", for example: ",(0,s.jsx)(n.code,{children:"_utils.ts"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["files in directory that name start with ",(0,s.jsx)(n.code,{children:"_"}),", for example: ",(0,s.jsx)(n.code,{children:"_utils/index.ts"}),"、",(0,s.jsx)(n.code,{children:"_utils/cp.ts"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["test files, for example: ",(0,s.jsx)(n.code,{children:"foo.test.ts"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["TypeScript define files, for example: ",(0,s.jsx)(n.code,{children:"hello.d.ts"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["files in ",(0,s.jsx)(n.code,{children:"node_module"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"define-function",children:["Define Function",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#define-function",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"In addition to the above routing rules, the function definition and export in the code also have conventions."}),"\n",(0,s.jsx)(n.p,{children:"function need named exports, and the name of the exported function is the HTTP Method:"}),"\n",(0,s.jsx)(n.div,{className:"language-",children:(0,s.jsxs)(n.div,{className:"modern-code-content",children:[(0,s.jsx)(n.button,{className:"copy"}),(0,s.jsx)(n.pre,{className:"code",children:(0,s.jsx)(n.code,{className:"language-ts",children:"export const get = async () => {\n  return {\n    name: 'Modern.js',\n    desc: 'Modern web Solutions',\n  };\n};\n"})})]})}),"\n",(0,s.jsxs)(n.p,{children:["Export the function like above will generate a ",(0,s.jsx)(n.code,{children:"POST"})," interface."]}),"\n",(0,s.jsxs)(n.p,{children:["App support 9 Method definitions: ",(0,s.jsx)(n.code,{children:"GET"}),"、",(0,s.jsx)(n.code,{children:"POST"}),"、",(0,s.jsx)(n.code,{children:"PUT"}),"、",(0,s.jsx)(n.code,{children:"DELETE"}),"、",(0,s.jsx)(n.code,{children:"CONNECT"}),"、",(0,s.jsx)(n.code,{children:"TRACE"}),"、",(0,s.jsx)(n.code,{children:"PATCH"}),"、",(0,s.jsx)(n.code,{children:"OPTION"}),"、",(0,s.jsx)(n.code,{children:"HEAD"}),". so App can use these name as function export nane."]}),"\n",(0,s.jsxs)(n.p,{children:["The name is insensitive, whaterver ",(0,s.jsx)(n.code,{children:"get"}),"、",(0,s.jsx)(n.code,{children:"Get"}),"、",(0,s.jsx)(n.code,{children:"GEt"}),"、",(0,s.jsx)(n.code,{children:"GET"}),", can be accurately identified. And default export, ",(0,s.jsx)(n.code,{children:"export default xxx"})," will be ",(0,s.jsx)(n.code,{children:"Get"})," method."]}),"\n",(0,s.jsxs)(n.p,{children:["because ",(0,s.jsx)(n.code,{children:"delete"})," is a keyword in JavaScript, use ",(0,s.jsx)(n.code,{children:"del"})," or ",(0,s.jsx)(n.code,{children:"DELETE"})," instead."]}),"\n",(0,s.jsx)(n.p,{children:"Multiple functions of different Methods can be defined in one file, but if multiple functions of the same Method are defined, only the first can work."}),"\n",(0,s.jsx)(n.p,{children:":::info\nIt should be noted that the defined functions should be asynchronous, which is related to the type when the function is called."})]})}var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},(0,d.useMDXComponents)(),e.components).wrapper;return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(c,e)})):c(e)}}}]);