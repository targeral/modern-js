(self.webpackChunkwebpack=self.webpackChunkwebpack||[]).push([["docs_zh_plugins_plugin-node-polyfill_mdx"],{68398:function(s,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(s,e){for(var l in e)Object.defineProperty(s,l,{enumerable:!0,get:e[l]})}(e,{frontmatter:function(){return r},toc:function(){return c},title:function(){return o},default:function(){return a}});var n=l("12151"),i=l("21447");let r=void 0,c=[{id:"快速开始",text:"快速开始",depth:2},{id:"安装插件",text:"安装插件",depth:3},{id:"注册插件",text:"注册插件",depth:3},{id:"node-polyfills",text:"Node Polyfills",depth:2},{id:"globals",text:"Globals",depth:3},{id:"modules",text:"Modules",depth:3},{id:"fallbacks",text:"Fallbacks",depth:3}],o="Node Polyfill 插件";function d(s){let e=Object.assign({h1:"h1",a:"a",div:"div",p:"p",h2:"h2",h3:"h3",button:"button",pre:"pre",code:"code",span:"span",ul:"ul",li:"li"},(0,i.useMDXComponents)(),s.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{id:"node-polyfill-插件",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#node-polyfill-插件",children:"#"}),"Node Polyfill 插件"]}),"\n",(0,n.jsxs)(e.div,{className:"modern-directive tip",children:[(0,n.jsx)(e.div,{className:"modern-directive-title",children:"Node Polyfill 介绍"}),(0,n.jsx)(e.div,{className:"modern-directive-content",children:(0,n.jsx)(e.p,{children:"\n通常情况下，我们不会在浏览器端使用 Node 模块。但在当前代码需要同时在 Node 端和浏览器端运行时，用到一些 Node 模块是有可能的。Node Polyfill 为这些 Node 模块提供了浏览器版本的 polyfills。"})})]}),"\n",(0,n.jsx)(e.p,{children:"通过使用 Node Polyfill 插件，会自动注入 Node 核心模块在浏览器端的 polyfills，让你可以在浏览器端放心使用这些模块。"}),"\n",(0,n.jsxs)(e.h2,{id:"快速开始",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#快速开始",children:"#"}),"快速开始"]}),"\n",(0,n.jsxs)(e.h3,{id:"安装插件",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#安装插件",children:"#"}),"安装插件"]}),"\n",(0,n.jsx)(e.p,{children:"你可以通过如下的命令安装插件:"}),"\n",(0,n.jsxs)(e.div,{className:"language-bash",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# npm"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"npm install @modern-js/builder-plugin-node-polyfill -D"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# yarn"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"yarn add @modern-js/builder-plugin-node-polyfill -D"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# pnpm"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"pnpm add @modern-js/builder-plugin-node-polyfill -D"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(e.h3,{id:"注册插件",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#注册插件",children:"#"}),"注册插件"]}),"\n",(0,n.jsxs)(e.p,{children:["在 Modern.js 等上层框架中，你可以通过 ",(0,n.jsx)(e.code,{children:"builderPlugins"})," 配置项来注册 node polyfill 插件："]}),"\n",(0,n.jsxs)(e.div,{className:"language-ts",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" { builderPluginNodePolyfill } "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'@modern-js/builder-plugin-node-polyfill'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"default"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  builderPlugins"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"builderPluginNodePolyfill"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()]"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"};"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(e.p,{children:["当你直接调用 Builder 的 Node API 时，可以通过 ",(0,n.jsx)(e.code,{children:"addPlugins"})," 方法来注册 node polyfill 插件："]}),"\n",(0,n.jsxs)(e.div,{className:"language-js",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" { builderPluginNodePolyfill } "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'@modern-js/builder-plugin-node-polyfill'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// 往 builder 实例上添加插件"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"builder"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".addPlugins"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(["}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"builderPluginNodePolyfill"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"()]);"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(e.h2,{id:"node-polyfills",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#node-polyfills",children:"#"}),"Node Polyfills"]}),"\n",(0,n.jsxs)(e.h3,{id:"globals",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#globals",children:"#"}),"Globals"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"Buffer"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"process"})}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"当你在代码中使用以上全局变量时，对应 polyfill 会被自动注入。"}),"\n",(0,n.jsxs)(e.div,{className:"language-ts",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"bufferData"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Buffer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'xxxx'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(e.h3,{id:"modules",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#modules",children:"#"}),"Modules"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"assert"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"buffer"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"console"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"constants"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"crypto"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"domain"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"events"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"http"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"https"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"os"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"path"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"punycode"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"process"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"querystring"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"stream"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"_stream_duplex"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"_stream_passthrough"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"_stream_readable"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"_stream_transform"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"_stream_writable"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"string_decoder"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"sys"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"timers"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"tty"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"url"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"util"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"vm"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"zlib"})}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["当你通过 ",(0,n.jsx)(e.code,{children:"require"})," 或 ",(0,n.jsx)(e.code,{children:"import"})," 等语法在代码中引用以上模块时，对应 polyfill 会被注入。"]}),"\n",(0,n.jsxs)(e.div,{className:"language-ts",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" { Buffer } "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'buffer'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"bufferData"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"Buffer"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'xxxx'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(e.h3,{id:"fallbacks",children:[(0,n.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#fallbacks",children:"#"}),"Fallbacks"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"child_process"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"cluster"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"dgram"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"dns"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"fs"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"module"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"net"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"readline"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"repl"})}),"\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:"tls"})}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"目前浏览器端没有以上模块的 polyfill，因此当你引用以上模块时，会自动 fallback 为一个空对象。"}),"\n",(0,n.jsxs)(e.div,{className:"language-ts",children:[(0,n.jsx)(e.div,{className:""}),(0,n.jsxs)(e.div,{className:"modern-code-content",children:[(0,n.jsx)(e.button,{className:"copy"}),(0,n.jsx)(e.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(e.code,{children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fs "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fs'"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(fs); "}),(0,n.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// -> {}"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})]})]})]})}var a=function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.useMDXComponents)(),s.components);return e?(0,n.jsx)(e,Object.assign({},s,{children:(0,n.jsx)(d,s)})):d(s)}}}]);